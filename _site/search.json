{
  "articles": [
    {
      "path": "about.html",
      "title": "About this blog",
      "description": "Some additional details about the blog",
      "author": [],
      "contents": "\r\n\r\n\r\n\r\n",
      "last_modified": "2021-07-24T03:20:11+08:00"
    },
    {
      "path": "index.html",
      "title": "Analysis of VAST challenge 2",
      "author": [],
      "contents": "\r\nTable of Contents\r\nIntroduction\r\nliterature review\r\nData preperation\r\nAnalysis and answers\r\nConclusion\r\nIntroduction\r\nIn the roughly twenty years that Tethys-based GAStech has been operating a natural gas production site in the island country of Kronos, it has produced remarkable profits and developed strong relationships with the government of Kronos. However, GAStech has not been as successful in demonstrating environmental stewardship.\r\nIn January, 2014, the leaders of GAStech are celebrating their new-found fortune as a result of the initial public offering of their very successful company. In the midst of this celebration, several employees of GAStech go missing. An organization known as the Protectors of Kronos (POK) is suspected in the disappearance, but things may not be what they seem.\r\nAnd we will going to identify anomalies and suspicious behaviors, and identify which people use which credit and loyalty cards.\r\nLiterature review\r\nAfter reading some seniors articles, I leaner from YiFei that it is useful to use a map track grouped by different department of employees. Besides, Han Ying’s assignments used a network to show the informal relationships, which helped to understand the linking bettwen employees.\r\nData preperation\r\nInstalling and lauching R packages\r\nFirst, we install and library all packages we might use. Here we need 3 parts of packages: data preparation, graph builder, and Rshiny.\r\n\r\n\r\npackages = c('ggiraph','tidyverse','plotly','lubridate','stringi','scales','hms','ggplot2','ggpubr','raster','tmap','sf','clock','gifski','mapview','ggthemes','bipartite','GGally','devtools','widgetframe','igraph','visNetwork','tidygraph','ggraph')\r\nfor(p in packages){\r\n  if(!require(p,character.only=T)){\r\n    install.packages(p)\r\n  }\r\n  library(p,character.only=T)\r\n}\r\n\r\nif(!require(ggbipart)){\r\n    devtools::install_github(\"pedroj/bipartite_plots\")\r\n  }\r\n  library(ggbipart)\r\nif(!require(ggnet)){\r\n    devtools::install_github(\"briatte/ggnet\")\r\n  }\r\n  library(ggnet)\r\n\r\n\r\n\r\nImporting Data\r\nWe have 14-days history transaction of credit card history and loyalty card (GAStech gave employees for credits), include the store name, price, datetime and card numder.\r\nBesides, we also have 14-days gps history of company’s car, which includes the name, gps, time. Also, we have list of employees’ name, department, job title and their assigned car ID.\r\n\r\n\r\ncarassignments <- read_csv(\"data/car-assignments.csv\")\r\nccdata <- read_csv(\"data/cc_data.csv\")\r\ngps <- read_csv(\"data/gps.csv\")\r\nloyaltydata <- read_csv(\"data/loyalty_data.csv\")\r\n\r\n\r\n\r\n\r\n\r\nloyaltydata$timestamp = mdy(loyaltydata$timestamp)\r\nloyaltydata$location=parse_character(loyaltydata$location, locale = locale(encoding = \"windows-1250\"))\r\nccdata$timestamp = mdy_hm(ccdata$timestamp)\r\nccdata$last4ccnum=as.character(ccdata$last4ccnum)\r\nccdata$location=parse_character(ccdata$location, locale = locale(encoding = \"windows-1250\"))\r\ngps$Timestamp<-mdy_hms(gps$Timestamp)\r\ngps$date<-date(gps$Timestamp)\r\n\r\n\r\n\r\nGAStech has 44 employees, 35 of them (expect drivers) has assigned car.\r\n\r\n\r\nknitr::kable(head(carassignments[,1:5]), \"simple\")\r\n\r\n\r\nLastName\r\nFirstName\r\nCarID\r\nCurrentEmploymentType\r\nCurrentEmploymentTitle\r\nCalixto\r\nNils\r\n1\r\nInformation Technology\r\nIT Helpdesk\r\nAzada\r\nLars\r\n2\r\nEngineering\r\nEngineer\r\nBalas\r\nFelix\r\n3\r\nEngineering\r\nEngineer\r\nBarranco\r\nIngrid\r\n4\r\nExecutive\r\nSVP/CFO\r\nBaza\r\nIsak\r\n5\r\nInformation Technology\r\nIT Technician\r\nBergen\r\nLinnea\r\n6\r\nInformation Technology\r\nIT Group Manager\r\n\r\nThere is 54 loyalty card record and 55 credit card record.\r\n\r\n\r\nknitr::kable(head(loyaltydata[,1:4]), \"simple\")\r\n\r\n\r\ntimestamp\r\nlocation\r\nprice\r\nloyaltynum\r\n2014-01-06\r\nBrew’ve Been Served\r\n4.17\r\nL2247\r\n2014-01-06\r\nBrew’ve Been Served\r\n9.60\r\nL9406\r\n2014-01-06\r\nHallowed Grounds\r\n16.53\r\nL8328\r\n2014-01-06\r\nCoffee Shack\r\n11.51\r\nL6417\r\n2014-01-06\r\nHallowed Grounds\r\n12.93\r\nL1107\r\n2014-01-06\r\nBrew’ve Been Served\r\n4.27\r\nL4034\r\n\r\n\r\n\r\nknitr::kable(head(ccdata[,1:4]), \"simple\")\r\n\r\n\r\ntimestamp\r\nlocation\r\nprice\r\nlast4ccnum\r\n2014-01-06 07:28:00\r\nBrew’ve Been Served\r\n11.34\r\n4795\r\n2014-01-06 07:34:00\r\nHallowed Grounds\r\n52.22\r\n7108\r\n2014-01-06 07:35:00\r\nBrew’ve Been Served\r\n8.33\r\n6816\r\n2014-01-06 07:36:00\r\nHallowed Grounds\r\n16.72\r\n9617\r\n2014-01-06 07:37:00\r\nBrew’ve Been Served\r\n4.24\r\n7384\r\n2014-01-06 07:38:00\r\nBrew’ve Been Served\r\n4.17\r\n5368\r\n\r\nAnd there is 35 cars GPS card and map. \r\nAnalysis and answers\r\nMost popular place\r\nThere is in total 34 shops employees have been visited. We notice that Katerina’s Café; Hippokampos; Guy’s Gyros; Brew’ve Been Served; Hallowed Grounds are most poplar places employees like. Unsurprisely, all of them provide food and beverage.\r\n\r\n\r\nccdata_popular<-ccdata %>%\r\n group_by(location) %>%\r\n  summarise(times=n()) %>%\r\n  arrange(desc(times))%>%\r\n  head(5)\r\n\r\nggplot(ccdata_popular,aes(x = reorder(location,-times),y=times))+\r\n  labs(y=\"Visit times\")+\r\n  labs(x=\"Locations\")+\r\n  geom_bar(fill = \"#669933\",stat = \"identity\", width = 0.5)+\r\n  theme(axis.text.x = element_text(face=\"bold\", size=7))+\r\n  ggtitle(\"Most Popular Locations\")\r\n\r\n\r\n\r\n\r\nLeast popular place\r\nAnd we also notice Daily Dealz, Frank’s Fuel, U-Pump, Abila Scrapyard, Octavio’s Office Supplies are the least shops. We notice only one employee (we only know his credit number) visited Daily Dealz. We might want to use these data cause it is earlier to find who visit those shops by gps data. So we can find out who owns this credit card.\r\n\r\n\r\nccdata_leastpopular<-ccdata %>%\r\n group_by(location) %>%\r\n  summarise(times=n()) %>%\r\n  arrange(desc(-times))%>%\r\n  head(5)\r\nccdata_leastpopular$location<-as.factor(ccdata_leastpopular$location)\r\n\r\nggplot(ccdata_leastpopular,aes(x = reorder(location,-times),y=times))+\r\n  labs(y=\"how many times customers visit\")+\r\n  labs(x=\"locations\")+\r\n  ggtitle(\"least popular locations\")+\r\n  geom_bar(fill = \"#669933\",stat = \"identity\", width = 0.5)+\r\n  theme(axis.text.x = element_text(face=\"bold\", size=7))\r\n\r\n\r\n\r\n\r\nWhich day the most popular shops have most employees visiting?\r\nWe notice that during weekend, few employees visit Guy’s Gyros.\r\n\r\n\r\nccdata_populartime<-ccdata %>%\r\n  filter(location %in% ccdata_popular$location) \r\n   ccdata_populartime$date=date(ccdata_populartime$timestamp)\r\n   \r\nccdata_populartime<-ccdata_populartime  %>%\r\n   group_by(date,location)%>%\r\n   summarise(customers=n())%>%\r\n   ungroup()\r\np1<-ggplot(ccdata_populartime, \r\n           aes(x=date, \r\n               y = customers\r\n               ,color=location\r\n               )) +\r\n  scale_x_date(date_breaks = \"1 days\",\r\n               labels = scales::label_date_short()\r\n               ) +\r\n   geom_line() +\r\n  ggtitle(\"Most popular shops by credit card\")\r\np1\r\n\r\n\r\n\r\n\r\nWhen the most popular shops have most employees visiting?\r\nWe can see from this graph, employees often visit Brew’ve Been Served & Hallowed Grounds in the morning (7am to 8am), and visit Katerina’s Café & Hippokampos & Guy’s Gyros at lunch time (12pm to 14pm) and after work (18pm to 22pm). From map, we can see except Hallowed Grounds, the rest four are all vary close GAStech, no wonder employees like eating lunch or relax there.\r\n\r\n\r\nccdata_populartime<-ccdata %>%\r\n  filter(location %in% ccdata_popular$location) \r\n   ccdata_populartime$hm=as_hms(ccdata_populartime$timestamp)\r\n   ccdata_populartime$hour=hour(ccdata_populartime$timestamp)\r\nccdata_populartime<-ccdata_populartime  %>%\r\n   group_by(hour,location)%>%\r\n   summarise(customers=n())%>%\r\n   ungroup()\r\nggplot(ccdata_populartime, \r\n           aes(x=hour, y = customers,color=location)) +\r\n  xlim(0,23)+\r\n   ggtitle(\"what time are shops most popular?\")+\r\n   geom_line() \r\n\r\n\r\n\r\n\r\nEmployees who hang out together\r\nWe also can find some interesting informal relationship between employees. For instance, we know golf is a good network sports and some of our employees do enjoy golf. Lets find out in our employees, who went Desafio Golf Course? When do they go?\r\nIn this graph, we notice that indeed three employees went golf on every Sunday. And two more employees joins on the second Sunday.\r\n\r\n\r\nccdata_popcus<-ccdata %>%\r\n  filter(location==\"Desafio Golf Course\")%>%\r\n  group_by(last4ccnum)%>%\r\n   summarise(times=n()) %>%\r\n  arrange(desc(times))%>%\r\n  head(10)%>%\r\n  ungroup()\r\n\r\nccdata_popcustime<-ccdata %>%\r\n   filter(location==\"Desafio Golf Course\" ) \r\nccdata_popcustime$date=date(ccdata_popcustime$timestamp)\r\n\r\nggplot(ccdata_popcustime,aes(x=date,y=last4ccnum,color=last4ccnum))+\r\n  scale_x_date(date_breaks = \"1 days\")+\r\n  theme(axis.text.x = element_text(angle = 90))+\r\n  ggtitle(\"Who and when visit Desafio Golf Course\")+\r\n   geom_point()\r\n\r\n\r\n\r\n\r\nThe ccnumber and loyalty number have alot in common\r\nThe loyalty card is given by GAStech to reward the customer for buying goods or services. So employees may use it while shopping and may not. If employees use it while shopping,it would has a same record in loyalty data as it in ccdata. This graph below shows the most popular shops by two dataset. The similarity of these two graphs shows a example that two data set have a lot in common, especially lines for Brew’ve Been Sreved, Guy’s Gyros and Hallowed Grounds.\r\n\r\n\r\nloyaltydata_popular<-loyaltydata %>%\r\n group_by(location) %>%\r\n  summarise(times=n()) %>%\r\n  arrange(desc(times))%>%\r\n  head(5)\r\n\r\nloyaltydata_populartime<-loyaltydata  \r\n   loyaltydata_populartime$date=date(loyaltydata_populartime$timestamp)\r\n  loyaltydata_populartime<-loyaltydata_populartime%>%\r\n  filter(location %in% loyaltydata_popular$location)%>%\r\n   group_by(date,location)%>%\r\n   summarise(customers=n())%>%\r\n   ungroup()\r\n  \r\n  p2<- ggplot(loyaltydata_populartime, \r\n           aes(x=date, y = customers,color=location)) +\r\n   scale_x_date(date_breaks = \"1 days\",\r\n               labels = scales::label_date_short()\r\n               ) +\r\n   geom_line() +\r\n   ggtitle(\"Most popular shops by loyalty card\")\r\n  \r\n   ggarrange(p1, p2,nrow = 2)\r\n\r\n\r\n\r\n\r\nGPS graph\r\nNow we will add gps data into our analysis. From this map we can identify some familiar shops we have in our ccdata and loyaltydata, such as: Bean There Done That, Brew’ve Been Served… There are also some shops not shown in this map, such as: Abila Zacharo, Hippokampos… This gives some challenges for us.\r\n\r\n\r\nbgmap <-raster(\"data/MC2-tourist.tif\")\r\ntm_shape(bgmap)+\r\n  tm_rgb(bgmap,r=1,g=2,b=3,\r\n   alpha=NA,\r\n   saturation=1,\r\n   interpolate=TRUE,\r\n   max.value=255)\r\n\r\n\r\n\r\nAbila_st <- st_read(dsn = \"data/Geospatial\",\r\n                    layer = \"Abila\")\r\n\r\n\r\nReading layer `Abila' from data source \r\n  `E:\\visual analytics\\assignment\\VASTMC2\\VASTMC2\\data\\Geospatial' \r\n  using driver `ESRI Shapefile'\r\nSimple feature collection with 3290 features and 9 fields\r\nGeometry type: LINESTRING\r\nDimension:     XY\r\nBounding box:  xmin: 24.82401 ymin: 36.04502 xmax: 24.90997 ymax: 36.09492\r\nGeodetic CRS:  WGS 84\r\n\r\ngps_sf <- st_as_sf(gps, \r\n                   coords = c(\"long\", \"lat\"),\r\n                       crs= 4326)\r\n\r\ngps_path <- gps_sf %>%\r\n  group_by(id, date) %>%\r\n  summarize(m = mean(Timestamp), \r\n            do_union=FALSE) %>%\r\nst_cast(\"LINESTRING\")\r\n\r\n\r\n\r\nThis graph shows the path of car2 and car3 have visited during 14 days.\r\nTheir path includes: home, GAStech (company), and food and beverage shops they visit.\r\nBesides, we notice car 3 went Frank’s Fuel once, which is one of the least popular shops.\r\nWhats more, we can see it clearly, the travel paths of driver2 (left) and driver3 (right) are almost the same. It might because they are both Engineer so they are together often.\r\n\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id==2) \r\n\r\ntmap2<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car2\")\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id==3)\r\ntmap3<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car3\")\r\n\r\ntmap_mode(\"plot\")\r\ntmap_arrange(tmap2,tmap3, ncol = 2)\r\n\r\n\r\n\r\n\r\nHowever, when we check all Site Control’s path. We can see the paths are all vary complex, especially car13 and car15. It seems that they visit a lot unclear places expect home, company and shops.\r\n\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==12 )\r\ntmap12<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car12\")\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==13 )\r\ntmap13<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car13\")\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==15 )\r\ntmap15<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car15\")\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==30 )\r\ntmap30<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car30\")\r\n\r\ntmap_mode(\"plot\")\r\ntmap_arrange(tmap12,tmap13, tmap15,tmap30,ncol = 2)\r\n\r\n\r\n\r\n\r\nIn Executives’ path, we can see all of them visited Desafio Golf as we noticed before.\r\n\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==32)\r\ntmap32<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car32\")\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==10)\r\ntmap10<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car10\")\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==4)\r\ntmap4<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car4\")\r\n\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==31)\r\ntmap31<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car31\")\r\n\r\ntmap_mode(\"plot\")\r\ntmap_arrange(tmap32,tmap10,tmap4,tmap31,ncol = 2)\r\n\r\n\r\n\r\n\r\nThe overall path gives us a general concept about where have each car’s owner visited during tha last 14 days. And we also notice 2 abnormal tracks: car 9 and 28.\r\n\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==9)\r\ntmap9<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car9\")\r\n\r\ngps_path_selected <- gps_path %>%\r\n  filter(id ==28)\r\ntmap28<-tm_shape(bgmap) +\r\n  tm_rgb(bgmap, r = 1,g = 2,b = 3,\r\n       alpha = NA,\r\n       saturation = 1,\r\n       interpolate = TRUE,\r\n       max.value = 255) +\r\n  tm_shape(gps_path_selected) +\r\n  tm_lines()+\r\n  tm_layout(title = \"Car28\")\r\n\r\ntmap_mode(\"plot\")\r\ntmap_arrange(tmap9,tmap28,ncol = 2)\r\n\r\n\r\n\r\n\r\nYet its hard to tell why the abnormal track happend. So, in order to find out the exact location of each car at specific datetime. We define a Rshiny app which can choose cardid, date, and hour range, to generate the dots on map.\r\nHere is the link to R shiny app.\r\n\r\n\r\nAfter checking track each day, we find that the gps system of these 2 car seems broken. For car 9, the gps data have a lot missing leading the noncontinuous track. For car 28, the gps data have a lot bias leading the track unstable.\r\nWhich ccnumber link to which loyaltynumber\r\nFrom the experice, we can infer that if one employee consume at a shop and use his loyalty card for credit, then the transaction record in both card should share the same location, time and price. With this hypothesis, we can find the relationship between ccdata and loyaltydata.\r\nFirst we create a viable named cond in both ccdata and loyaltydata. This viable contains the date, price and location of each transaction data. Then we merge two dataset if they share same cond, which imply the cc number and loyalty number are owned by one person.\r\nThe outcome dataset relation records all mappings between cc number and loyalty number, as well as the frequency of this mapping (the higher frequency is, the more credible this mapping is).\r\n\r\n\r\nccdata_rela <- ccdata \r\nccdata_rela$date <- date(ccdata_rela$timestamp)\r\nccdata_rela$cond <- as.character(paste(ccdata_rela$date,ccdata_rela$price,ccdata_rela$location)) \r\n\r\nloyaltydata_rela<-loyaltydata \r\nloyaltydata_rela$cond <- as.character(paste(loyaltydata_rela$timestamp,loyaltydata_rela$price,loyaltydata_rela$location)) \r\n\r\nrelation<- merge(loyaltydata_rela, ccdata_rela, by = \"cond\")%>%\r\n   mutate(cond=NULL,timestamp.x=NULL,location.x=NULL, price.x=NULL,date=NULL,timestamp.y=NULL,location.y=NULL,price.y=NULL,\r\n          lower=loyaltynum,higher=last4ccnum,\r\n          loyaltynum=NULL,last4ccnum=NULL)%>%\r\n  group_by(lower,higher)%>%\r\n  summarise(freq=n()) %>%\r\n  ungroup() #%>%\r\n\r\n\r\n\r\nHowever, we found some abnormal mapping: either one credit card mapping to 2 loyalty card or one loyalty card mapping to 2 credit card.\r\nThese abnormal mapping might imply the 2 owners are very intimate or there are suspicious activities.\r\n\r\n\r\nrelation1<-relation %>%\r\n  group_by(higher)%>%\r\n  summarize(n = n())%>%\r\n  filter(n>1)%>%\r\nungroup()\r\n\r\nrelation2<-relation %>%\r\n  group_by(lower)%>%\r\n  summarize(n = n())%>%\r\n  filter(n>1)%>%\r\nungroup()\r\n\r\nrelation_abplot<-relation %>%\r\n mutate(freq=NULL,freq=1) %>%\r\n filter(higher %in% relation1$higher | lower %in% relation2$lower)\r\n\r\nweb<-frame2webs(relation_abplot,varnames = c(\"lower\", \"higher\", \"freq\"),emptylist=FALSE)\r\n\r\n#plotweb(web[[\"1\"]])\r\nbip_railway(web[[\"1\"]], label=T)+ \r\n  ggtitle(\"Abnormal mapping between ccnum and loyaltydata\")+\r\n  coord_flip()\r\n\r\n\r\n\r\n\r\nNormal link:\r\n\r\n\r\nrelation_normal<-relation %>%\r\n  filter (!(higher %in% relation1$higher)) %>%\r\n  filter (!(lower %in% relation2$lower))\r\n\r\n\r\n\r\nMapping carid and ccnum\r\nNow we have the transaction history of each employee and the track history of each car. So if any employee consumes at a certain store, for example, he consumes at Brew’ve Been Served at Jan 6th 13pm, the transaction history will record the time and store name while the gps history will also record time and gps(which inferred the store name). So we can find one data in ccdata records: cc card 1234 consumes at Brew’ve Been Served at Jan 6th 13pm. Also we can find one data in gps records: car 4 stops at Brew’ve Been Served at Jan 6th 13pm. Then we know car4’s owner Ingrid own car 1234.\r\nWith the help of Rshiny app, we find these relationship:\r\n\r\n\r\nmapping <- read_csv(\"data/mapping.csv\")\r\n\r\n\r\n\r\nInfornal relationship between employees\r\nAfter analyzing the daily track of employees, we find some informal relationship (use car id refer to employee): 1. ID14, 18 live together.\r\n2. ID7, 33 go to GHOSTUS Hotel every Tuesday and Thursday.\r\n3. Executives go to Desafio Golf Course every Sunday. 4. ID22, 28 enjoys eating or going to museum together.\r\n5. ID15,16,33,34 went to 4,10,18,32,35’s house midnight or while they are not home.\r\n21 went to 14 and 18’s house almost everyday.\r\n24 use 1’s credit card on something expensive.\r\n13, 15, 16 went out during work time together.\r\nalmost every one in IT/Engineering department go to 2’s house after work on a Friday.\r\nThis is the network graph of those informal relationship:\r\n\r\n\r\nedges<- read_csv(\"data/edges.csv\")\r\nnode<-carassignments\r\nnet <- tbl_graph(nodes = node,\r\n                           edges = edges, \r\n                           directed = FALSE)\r\nnet <-net %>%\r\n  activate(edges) %>%\r\n  arrange(desc(freq))\r\ng <- ggraph(net,layout = \"nicely\") + \r\n  geom_edge_link(aes(width=freq),alpha=0.5) +\r\n  geom_node_point(aes(colour = CurrentEmploymentType, \r\n                      size = 3))+\r\n  scale_edge_width(range = c(0.1, 2))+\r\n  geom_node_text ( aes ( label = CarID ) )\r\ng + theme_graph()\r\n\r\n\r\n\r\n\r\nConclusion:\r\n15,16,33,34 seems the most specious employees. They visited executives’ house in order while midnight or weekend while executives were sleeping or outside. They visited 35’s house most frequently, who is the Environmental Safety Advisor of GAStech Company. This the especially made us think the possibility they are involved with this case.\r\n\r\n\r\n\r\n",
      "last_modified": "2021-07-26T00:05:58+08:00"
    }
  ],
  "collections": ["posts/posts.json"]
}
